{% extends "bootstrap/mybase_offline.html" %} 
{% block title %} UliGra - Kaggle {% endblock title %} 

{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{url_for('.static',filename='starter-template.css')}}"> 
{% endblock styles %}

{% block content %}
<style>
    body {
    background-color: aliceblue;
  }
</style>
<div class="container padding-0 div_center">
    <h1 class="div_center"> Competiciones</h1>
    <div class="starter-template" id="competiciones"></div>
    
</div>
<script type="text/babel">
    var Competicion = React.createClass({
        getInitialState: function (){  
            return {} 
        }, 

        render: function () { 
            var url = "/ranking/" + this.props.children.code;
            var image = "/images/i" + this.props.children.number + ".jpg"
            return (
                <div className="col-md-3 col-md-offset-1 panel padding-0">
                    <div className="panel-body hovereffect">
                        <img src={image} className="img-responsive"></img>
                        <div className="overlay">
                            <h2> {this.props.children.descripcion}</h2>                                        
                            <h3>By: {this.props.children.username}</h3>                                        
                            <a href={url} className="info btn btn-primary">Ver competicion.</a>    
                        </div>
                       
                    </div>
                </div>
            )
        }
    }); 

    var Board = React.createClass({
        getInitialState: function () { 
            return {  
                comps: [] 
            } 
        }, 
        eachComp: function (text, i) { 
            console.log(text);
            return (
                <Competicion key={i} code={text.code} desc={text.code} user={text.user}>
                    {text}
                </Competicion>
            )
        },

        componentDidMount() { 
            fetch('http://localhost:5000/competiciones')
            .then(response => response.json())
            .then(data => {
                this.setState({ comps: data });
            }); 
        }, 

        render: function () {
            return (
                <div>
                    <div className="row">
                        {this.state.comps.map(this.eachComp)}
                    </div>
                </div>
            )
        }   
    });

    ReactDOM.render( <Board/>, document.getElementById('competiciones'));
</script>

{% endblock content %}